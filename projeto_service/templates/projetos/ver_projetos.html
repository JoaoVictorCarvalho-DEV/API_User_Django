{% extends "../base/base.html" %}
{% block template %}
<div class="container mx-auto px-4 py-8">
    <h1 class="text-3xl font-bold text-gray-800 mb-6">
        <i class="bi bi-bookmark-check-fill mr-2"></i>Projetos
    </h1>
    
    <div class="bg-white rounded-lg shadow overflow-hidden">
        <div class="h-[75vh] overflow-y-auto p-4">
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4" id="listaProjetos"></div>
        </div>
    </div>

    <div id="message" class="hidden fixed top-4 right-4 bg-green-500 text-white px-4 py-2 rounded-md shadow-lg"></div>
</div>

<script>
    function exibirMensagem(mensagem, sucesso = true) {
        const elemento = document.getElementById('message');
        elemento.textContent = mensagem;
        elemento.classList.remove('hidden', 'bg-green-500', 'bg-red-500');
        elemento.classList.add('block', sucesso ? 'bg-green-500' : 'bg-red-500');
        
        setTimeout(() => {
            elemento.classList.add('hidden');
        }, 5000);
    }

    async function carregarProjetos(userId) {
        const response = await fetch(`/api/v1/projetos`);
        const projetos = await response.json();

        const container = document.getElementById("listaProjetos");
        container.innerHTML = '';

        projetos.forEach(projeto => {
            const card = document.createElement('div');
            card.className = 'border border-gray-200 rounded-lg overflow-hidden hover:shadow-md transition-shadow';
            card.innerHTML = `
                <a href="../ver_projeto/${projeto.id}" class="block">
                    <div class="p-4">
                        <h3 class="text-lg font-semibold text-gray-800">${projeto.nome}</h3>
                        <p class="text-gray-600 text-sm mt-1 truncate">${projeto.descricao}</p>
                        <div class="mt-3 flex justify-between items-center">
                            <span class="text-xs text-gray-500">${projeto.data_inicio} - ${projeto.data_final}</span>
                            <span class="px-2 py-1 text-xs rounded-full ${projeto.status === 'ConcluÃ­do' ? 'bg-green-100 text-green-800' : 'bg-blue-100 text-blue-800'}">
                                ${projeto.status}
                            </span>
                        </div>
                    </div>
                </a>
            `;
            container.appendChild(card);
        });
    }

    window.onload = () => carregarProjetos({{ user_id }});
</script>
{% endblock %}